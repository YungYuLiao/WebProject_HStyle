# H'Style 精品服飾網站

**Keyword: ASP.NET MVC、ASP.NET Core、WebAPi、三層式架構(表現層、業務邏輯層、資料存取層)、Vue3 composition API、前後端分離**  
- 此為多人合作專案(6人)，專案僅供資展國際專題發表及練習使用，無任何商業用途，如有侵權煩請告知
- 專案理念: 針對中高端客群精品消費需求所設計，向消費者提供更全方位的服務，如個人專屬推薦、建立自媒體及客戶關係的管理等
1. 具前後台，後台為管理用途，前台則是給消費者使用
2. 後台以ASP.NET MVC架構撰寫
3. 前台則使用前後端分離的方式，後端使用ASP.NET Core來開發WebAPi服務，前端則使用Vue框架，前後端之間以AJAX技術呼叫
4. 以MS SQL作為資料庫，並使用EntityFramework存取，並創建Azure雲端資料庫以因應共同開發時的資料編輯需求
5. 以GitHub作為版控工具
6. 從資料庫中返回的資料為多筆時，以IEnumerable<T>泛型介面回傳，開發人員可以根據自己的需要選擇轉換成List<T>或Array等型別，可以減少記憶體佔用，並提高效能

### 以下為負責部分介紹
## 後台
### 訂單管理
1. 以三層式架構撰寫，並在Repository實作Interface(介面)，提高程式碼可讀性與可維護性
2. 撰寫擴充方法，進行ToVM和ToDTO的轉型
3. 在Controller以private存取修飾詞用於儲存自資料庫取回的資料，保護數據的封裝性，讓外部的使用者不能直接訪問這些數據，以建構子注入（Constructor Injection）方式來初始化
4. 利用PagedList和AJAX技術製作分頁，並用MVC中SelectListItem繫結DropDownList，改變pageSize，以達成選取呈現幾筆資料的效果
5. 使用JQuery處理前端，提升使用者體驗，如：一選擇訂單狀態或每頁呈現幾筆的下拉式選單時數據隨即更新，並配合AJAX技術做出搜尋時的autocomplete(顯示前五筆資料配對到的資料)
  
  ![Recording 2023-03-29 at 15 57 29](https://user-images.githubusercontent.com/115922701/228466078-a87d9123-b0b6-437c-8661-8dd0959f8d74.gif)

6. 以JQuery實作一鍵出貨(自動填入訂單狀態及出貨時間)
* 訂單管理首頁設定僅訂單狀態為待出貨才能被全選checkbox選到，是利用checkbox的disabled屬性達成
* 訂單修改頁的一鍵出貨button判斷是否為待出貨狀態，若不是則以hide屬性作按鈕隱藏
7. 一頁式操作: 
* 變更訂單狀態可在訂單管理首頁操作，是以form自動繫結Controller動作方法的參數，在動作方法用for迴圈做逐一修改
* 訂單詳情利用Boostrap的Collapse點按後即可展示配送詳情及訂單商品詳情，並且可檢視、列印撿貨單，是以JavaScript的print實作列印功能
  
  ![Recording 2023-03-29 at 16 05 02 (1)](https://user-images.githubusercontent.com/115922701/228468108-b5251165-df70-4c35-ade2-7bbe575a480a.gif)

8. 若需由客服端取消訂單，則需要進入修改訂單頁方能操作，取消訂單以Boostrap的Modal實作，並可選擇是否寄信通知顧客訂單取消，以選取的取消訂單描述作為信件內容，再使用Google SMTP來實作後端寄信，取消訂單的原因也會顯示在訂單詳情中　　

  ![擷取](https://user-images.githubusercontent.com/115922701/228470749-d8d9ace4-7ea0-4065-830b-ea8106796df5.PNG)

9. 利用HttpContext.User 屬性`this.User.Identity.Name;`，取得已驗證的操作員工的帳號，並記錄在訂單操作(Log)
10. 訂單狀態的下拉式選單設計上，若更改為下一個狀態進程後就不能往回選擇，避免操作者誤改
### 資料表設計:
* 訂單取消不直接刪除資料庫中資料，而是以狀態欄位紀錄是否取消，好處是當需要對訂單進行帳務對帳時，可避免因為刪除資料而導致帳務錯誤，也可以查詢已取消的訂單
* 紀錄客戶取消訂單時間，以比對7天鑑賞期是否已過
* 訂單、訂單狀態、訂單狀態描述、訂單詳情及訂單操作分別都有各自的資料表，以實現第二正規化
* 訂單操作資料表不與其他表作關聯，以達確切紀錄的功用
#### ＊另負責後台主頁呈現和_Layout.cshtml套版
## 前台
* 利用axios套鍵處理AJAX，並以Vue3 composition API方式編寫
* 在Controller以private存取修飾詞用於自資料庫取回或不可變的資料，保護數據的封裝性，讓外部的使用者不能直接訪問這些數據，以建構子注入（Constructor Injection）方式來初始化
* 將會被重複使用的元素封裝成組件，並在不同的地方使用不同的屬性值進行呈現，達成組件化，以v-for呈現多筆
* 除商品瀏覽外其他功能皆須會員登入，經驗證後才能使用
### 商品推薦(三種推薦模式)
1. 天氣推薦:串接中央氣象局API，取的每六小時即會更新的最高溫及最低溫，再將中央氣象局取得的溫度，利用Dictionary查找溫度區間並轉換成舒適度指數，並在商品上篩選帶有舒適感的標籤　　  
  -- UI設計：根據使用者電腦時間白天(6-18)和黑夜(18-6)變更背景色系，並以JavaScript監聽視窗滾動高度添加背景的class屬性，給予觀看推薦商品的消費者一個沉浸式體驗
  ![廖永瑀](https://user-images.githubusercontent.com/115922701/228513610-9c506467-c33c-4ef2-bad5-3d8160a26eff.jpg)

2. 會員專屬推薦:未登入或未購買商品之會員則是推薦新品，若是登入狀態，以會員訂單中曾購買過的商品為依據，統計出現最多次的特色標籤，搜尋同樣有此標籤的其他商品作為專屬推薦，這裡運用了LINQ語法SelectMany取得下一層的集合
3. 猜你喜歡:以此頁的商品所帶有的標籤來搜尋其他帶有相同標籤的商品，並以Guid的雜湊碼作為random的種子值，再用洗牌演算法(交換法)產生隨機亂數，取出三個商品，且避免重複推薦，而若不滿三個商品則以其他相同顏色商品做替代  
以上皆有使用LINQ 語法Distinct避免取到相同商品
### 商品瀏覽、收藏、評論　　
  ![Recording 2023-03-29 at 19 13 17](https://user-images.githubusercontent.com/115922701/228516965-abbc6365-ae87-4d10-952f-d01164c0be4c.gif)　　
1. 商品瀏覽: 所使用到的技術是以動態路由傳遞參數到組件，用於呈現不同的商品分類如新品、全部商品及各種商品類別  
  -- UI設計：以v-if和v-else搭配mouseover和mouseout呈現滑鼠進入時照片變更的效果，並利用css中的hover實踐照片放大的效果
2. 以Vue做前端篩選及排序，語法分別為`filter`和`sort`，此做法是為提升效能，以減少拜訪資料庫的次數，在顏色篩選選項上將資料庫取得的規格中的顏色陣列以`flatMap()`語法扁平化，再以`new Set()`方式獲得唯一值的集合，最後使用`Array.from()`從 Set 對象創建一個新陣列
3. 商品收藏: 因需在不同組件間傳遞，以mitt套件實現跨模組的溝通功能　　
4. 單品瀏覽: 使用Swiper套件和VueEasyLightbox套件，分別呈現照片垂直輪播功能及點按照片後放大預覽的效果，以v-if和v-else方式切換商品描述和商品評論　　
![Recording 2023-03-29 at 19 19 46](https://user-images.githubusercontent.com/115922701/228518994-79c2fec1-ad42-4017-8292-1a79e6fda142.gif)　　

5. 商品評論:　　 
  ![image](https://user-images.githubusercontent.com/115922701/228519977-e0045a75-dfb2-4d70-8c5b-0dfa6e600f2a.png)　　
* 由訂單查詢才能點選評論商品，此作法可避免未購買過商品的人做評論，以保評論的真實性評論
* 利用formData傳數據至後端，並可多檔案上傳，並設有照片數量、大小限制
* 評論呈現設有評論是否有幫助的意見回饋，並利用mitt監聽做一個即時計數的功能，提供其他消費者作為參考

### 資料表設計:
* 商品評論設商品ID及訂單ID為外鍵
* 評論照片存至指定資料夾，以中介表(雙主鍵)做連結，並以images資料表統一管理照片且只儲存照片名稱，取資料時在轉型DTO時加上照片的存放路徑，可減少資料庫存放負擔
* 評論是否有幫助是雙主鍵表，分別以會員ID和評論ID為主鍵，紀錄哪個會員按哪筆評論有幫助
  
#### ＊另負責前台主頁(含header、footer及回頂部功能)、整體主視覺設計及協助組員撰寫template、調整畫面一致性
